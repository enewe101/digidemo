{% extends "digidemo/__two_column.html" %}
{% load staticfiles %}
{% block proposal_content %}

	<div align="right"> Last Modified {{proposal.last_modified}} </div>

	<form class="{{ edit_proposal_form.form_class}}" 
		id="{{ edit_proposal_form.form_class }}_{{ include_id }}" 
		action="{{ edit_proposal_form.endpoint }}" 
		method="post" />

		{% csrf_token %}

		<!-- include the proposal version edit form -->
		<div class="form_line">
			<div>
				{{ edit_proposal_form.proposal_version_form.title.label_tag }}
			</div>
			<div>
				{{ edit_proposal_form.proposal_version_form.title }}
			</div>
		</div>
		<div class="form_line">
			<div>
			{{ edit_proposal_form.proposal_version_form.summary.label_tag }}
			</div>
			<div>
				{{ edit_proposal_form.proposal_version_form.summary }}
			</div>
		</div>

		<!-- include the factor formset managers -->
		{% include "digidemo/_w_simple_form.html" with form=edit_proposal_form.factor_form_managers.pos %}
		{% include "digidemo/_w_simple_form.html" with form=edit_proposal_form.factor_form_managers.neg %}

		<!-- start of proposal factors formsets -->
		<div id="proposal_factor_forms">
			<div class="factor_form_left_column">

				<div class="factor_list_heading">
					Foreseen benefits:
				</div>

				<!-- include the positive factor forms -->
				{% for f in edit_proposal_form.factor_formsets.pos %}
					{% include "digidemo/_w_factor_form.html" with form=f include_id=forloop.counter0 valence="pos" %}
				{% endfor %}

			</div>
			<div class="factor_form_right_column">

				<div class="factor_list_heading">
					Foreseen hazards:
				</div>

				<!-- include the negative factor forms -->
				{% for f in edit_proposal_form.factor_formsets.neg %}
					{% include "digidemo/_w_factor_form.html" with form=f include_id=forloop.counter0 valence="neg" %}
				{% endfor %}

			</div>
			<div class="clear"></div>
		</div>
		<!-- end of proposal factor formsets -->

		<div class="form_line">
			<div>
				{{ edit_proposal_form.proposal_version_form.text.label_tag }}
			</div>
			<div>
				{{ edit_proposal_form.proposal_version_form.text }}
			</div>
		</div>

		<input id="{{ form.form_class}}_{{ include_id }}_submit" 
			class="submit" type="submit" value="submit" />

	</form>


	<!-- proposal title -->
	<h2> Proposal Title </h2>
	<textarea id="proposalTitle" rows="2" cols="70"> 
		{{proposal.get_latest.title}} 
	</textarea>
	
	<!-- TODO: add proposal summary -->

	<!-- proposal text -->
	<h2> Proposal Text </h2>
	<div class="take_note">
		<textarea id="proposalText" rows="25" cols="70">
			{{proposal.get_latest.text}} 
		</textarea>
	</div>
	
	<h2> Proposal Factors </h2>

	<!-- begin the editable list of bad factors -->
	<div class="factor_left_column">
		<textarea id="goodFactors" rows="10" cols="35">
			{% for factor in proposal.factor_set.all %}
				{% if factor.valence > 0 %}
					<br>{{ factor.description }}
				{% endif %}
			{% endfor %}
		</textarea>
	</div>
	<!-- end the editable list of bad factors -->

	<!-- begin the editable list of good factors -->
	<div class="factor_list_heading">
		<textarea id="badFactors" rows="10" cols="35">
			{% for factor in proposal.factor_set.all %}
				{% if factor.valence < 0 %}
					<br>{{ factor.description }}
				{% endif %}
			{% endfor %}
		</textarea>
	</div>
	<!-- end the editable list of good factors -->

	<div align="right">
		{% include "digidemo/_w_post_edit.html" %} 
	</div>

{% endblock proposal_content %}

	
